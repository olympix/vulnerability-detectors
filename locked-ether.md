## Contracts that lock ether

* **Vulnerability ID:** `locked-ether`
* **Severity:** `Medium`
* **Confidence:** `High`
* **Difficulty:** Easy
* **Versions affected:** All

## Detection rule
Flag if a contract contains any `payable` functions but does not have any calls to `.send()` or `.transfer()`.

## Historic Exploit:

## Vulnerable Example
```solidity
// SPDX-License-Identifier: Unlicense
pragma solidity 0.8.0;

contract Locked {
    function receive() payable public{
    }
}
```

### Why is this a problem?
In the code above, the contract exposes a payable function for receiving ether, but does not have any functions which send the contract's ether elsewhere, locking any ether received inside the contract.

#### Further reading:

## Corrected Example
#### For contracts which may recieve ether, ensure that there is functionality to move it elsewhere.
```solidity
// SPDX-License-Identifier: Unlicense
pragma solidity 0.8.0;

contract Unlocked {
    mapping(address => uint) public balances;

    function receive() payable public{
        balances[msg.sender] += msg.value;
    }

    function withdraw(uint amount) public{
        require(balances[msg.sender] >= amount);
        balances[msg.sender] -= amount;
        msg.sender.transfer(amount);
    }
}
```
