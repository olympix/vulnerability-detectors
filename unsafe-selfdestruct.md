## `selfdestruct` used directly in public or external function

* Vulnerability ID: ```unsafe-selfdestruct```
* Severity: High
* Confidence: High
* Difficulty: Easy
* Versions affected: All

## Detection rule:
Flag if a self-destruct keyword (including deprecated terms for older versions) is used directly inside of a call to a public or external function.

## Historic Exploit:

## Vulnerable Example
```solidity
// SPDX-License-Identifier: Unlicense
pragma solidity 0.4.22;

contract Vulnerable{
    function destroyContract() public{
        selfdestruct(payable(msg.sender));
    }
}
```

### Why is this a problem?
In the vulnerable example above, anyone may call this function, destroying it and sending any ether it holds to the caller of the function. In general, allowing anyone to destroy a contract (even if funds are not at risk) is likely to be unintended behavior.

#### Further reading:

## Corrected Example
#### Instead, safeguard legitimate calls to self-destruct capabilities by using controlled functions.
```solidity
// SPDX-License-Identifier: Unlicense
pragma solidity 0.4.22;

contract ProtectedSelfDestruct {
    function ProtectedSelfDestruct() {
        checkBeforeDestroy();
    }

    function checkFirst() private {
        // validate some condition here, such as the sender being the contract owner
        selfdestruct(payable(msg.sender));
    }
}
```
