## Calls inside loop that may lead to denial-of-service

* Vulnerability ID: ```calls-in-loop```
* Severity: Low
* Confidence: Medium
* Difficulty: Easy
* Versions affected: All

## Detection rule:
Flag if a call to `.send()` or `.transfer()` is present inside of a loop.

## Historic Exploit:

## Vulnerable Example
```solidity
// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.0

contract CallsInLoop {

    address[] destinations;

    constructor(address[] newDestinations) public {
        destinations = newDestinations;
    }

    function bad(int amount) external {
        for (uint i=0; i < destinations.length; i++) {
            destinations[i].transfer(amount);
        }
    }
}
```

### Why is this a problem?
In the vulnerable example above, if a destination address has a fallback function that reverts, the loop will never complete.

#### Further reading:

## Corrected example
```solidity
// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.0

contract Updated {

    address[] destinations;

    constructor(address[] newDestinations) public{
        destinations = newDestinations;
    }

    function sendToDestination(int i, int amount) external {
        // check that i represents a semantically valid array slot
        destinations[i].transfer(amount);
    }
}
```
