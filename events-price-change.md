## Changing a price without emitting a corresponding event

* **Vulnerability ID:** `events-price-change`
* **Severity:** `Low`
* **Confidence:** `Medium` (or `Low`)
* **Difficulty:** Medium
* **Versions affected:** All

## Detection rule
Flag if a variable with `price` in its name is being written to, with no event emitted in the same block.

## Historic Exploit:

## Vulnerable Example
```solidity
// SPDX-License-Identifier: Unlicense
pragma solidity 0.8.0;

contract C {

    modifier onlyOwner {
        if (msg.sender != owner) throw;
        _;
    }

    function setBuyPrice(uint256 newBuyPrice) onlyOwner public {
        buyPrice = newBuyPrice;
    }

    function buy() external {
     ... // buyPrice is used to determine the number of tokens purchased
    }    
}
```

### Why is this a problem?
In the code above, the price at which tokens may be purchased from the contract can be changed without emitting an event notifying users of such.

#### Further reading:

## Corrected Example
#### When changing a price parameter, emit a corresponding event.
```solidity
// SPDX-License-Identifier: Unlicense
pragma solidity 0.8.0;

event PriceUpdated(uint256 indexed _newPrice);

contract C {

    modifier onlyOwner {
        if (msg.sender != owner) throw;
        _;
    }

    function setBuyPrice(uint256 newBuyPrice) onlyOwner public {
        buyPrice = newBuyPrice;
        emit PriceUpdated(newBuyPrice);
    }

    function buy() external {
     ... // buyPrice is used to determine the number of tokens purchased
    }    
}
```
